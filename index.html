<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Sistema em Slides</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * { box-sizing: border-box: 12px; margin: 10; padding: 10; font-family: Arial, sans-serif; }
    body { background: #f0f0f0; }
    .slide { display: none; padding: 60px; }
    .ativo { display: block; }
    .btn { padding: 10px 20px; margin: 5px; background: #333; color: #fff; border: none; cursor: pointer; }
  </style>
</head>
<body>

<!-- SLIDE 0: LOGIN -->
<div id="slide0" class="slide ativo">
  <style>
    #slide0 { background: #fff; text-align: center; }
  </style>
  <h2>Login</h2>
  <input id="usuario" placeholder="Usuário" /><br><br>
  <input id="senha" type="password" placeholder="Senha" /><br><br>
  <button class="btn" onclick="fazerLogin()">Entrar</button>

  <script>
    function fazerLogin() {
      const user = document.getElementById('usuario').value;
      const pass = document.getElementById('senha').value;
      if ((user === 'Benedito' || user === 'Pedro' || user === 'Chaguinha') && pass === '1552') {
        localStorage.setItem('usuarioLogado', user);
        showSlide(1);
      } else {
        alert('Usuário ou senha incorretos');
      }
    }
  </script>
</div>

<!-- SLIDE 1: PAINEL -->
<div id="slide1" class="slide">

  <style>
    #slide1 { background: #e0ffe0; }
  </style>
  <h2>Painel Principal</h2>
  <p>Bem-vindo, <span id="nomeUsuarioPainel"></span></p>
  <button class="btn" onclick="showSlide(2)">Usuário</button>
  <button class="btn" onclick="showSlide(3)">Cadastro</button>
  <button class="btn" onclick="showSlide(4)">Vendas</button>
  <button class="btn" onclick="showSlide(5)">Devedores</button>
  <button class="btn" onclick="showSlide(6)">Caixa</button>
  <button class="btn" onclick="showSlide(7)">LANCAMENTOS</button>
  <button class="btn" onclick="showSlide(8)">Relatorio</button>
  <button class="btn" onclick="showSlide(9)">backup</button>
  <button class="btn" onclick="showSlide(10)">Zerar</button>
  <button class="btn" onclick="showSlide(0)">Sair</button>

  <script>
    document.getElementById('nomeUsuarioPainel').innerText = localStorage.getItem('usuarioLogado') || '';
  </script>
</div>

<!-- SLIDE 2 ao 9: EM BRANCO POR ENQUANTO -->

<!-- SLIDE 2 - USUÁRIO -->
<div class="slide" id="slide2" style="padding:20px; background:#eef7ff;">



  <p>Olá, <span id="nomeUsuario"></span>!</p>

  <p>Aqui você pode acessar os arquivos e históricos do sistema:</p>

  <a href="https://drive.google.com/drive/folders/1Lrx8H0HdifNR_q85YoLjF8nCxxqr0sB1?usp=drive_link" target="_blank" 
     style="display:inline-block; padding:10px 15px; background:#4285f4; color:#fff; border-radius:5px; text-decoration:none; margin-bottom:20px;">
    Abrir pasta do Google Drive
  </a>

  <h3>Lista de Vendedores</h3>

  <table border="1" width="100%" style="border-collapse: collapse; margin-bottom: 15px;">
    <thead>
      <tr style="background:#ddd;">
        <th>Nome</th>
        <th>Localidade</th>
        <th>Cotação</th>
        <th>Ações</th>
      </tr>
    </thead>
    <tbody id="listaVendedores"></tbody>
  </table>

  <!-- Modal simples para editar vendedor -->
  <div id="modalEditar" style="display:none; position: fixed; top:50%; left:50%; transform: translate(-50%, -50%);
      background:#fff; border: 1px solid #ccc; padding: 20px; z-index: 1000; width: 300px; box-shadow: 0 0 10px rgba(0,0,0,0.3);">
    <h3>Editar Vendedor</h3>
    <form id="formEditarVendedor">
      <label>Nome:</label>
      <input type="text" id="editNome" required style="width: 100%; margin-bottom: 10px;">
      <label>Localidade:</label>
      <input type="text" id="editLocalidade" required style="width: 100%; margin-bottom: 10px;">
      <label>Cotação:</label>
      <input type="number" step="0.01" id="editCotacao" required style="width: 100%; margin-bottom: 10px;">
      <button type="submit" style="margin-right: 10px;">Salvar</button>
      <button type="button" onclick="fecharModalEditar()">Cancelar</button>
    </form>
  </div>

  <div id="overlayModal" style="display:none; position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.4); z-index: 999;"></div>

  <script>
    function carregarNomeUsuario() {
      const nome = localStorage.getItem('usuarioLogado') || 'Usuário';
      document.getElementById('nomeUsuario').textContent = nome;
    }

    // Carrega a lista de vendedores da storage e popula a tabela
    function carregarVendedores() {
      const lista = document.getElementById('listaVendedores');
      lista.innerHTML = '';
      const vendedores = JSON.parse(localStorage.getItem('vendedores') || '[]');

      vendedores.forEach((vendedor, index) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${vendedor.nome}</td>
          <td>${vendedor.localidade}</td>
          <td>${parseFloat(vendedor.cotacao).toFixed(2)}</td>
          <td>
            <button onclick="abrirModalEditar(${index})">Editar</button>
            <button onclick="excluirVendedor(${index})" style="margin-left:5px; color: red;">Excluir</button>
          </td>
        `;
        lista.appendChild(tr);
      });
    }

    // Modal editar
    function abrirModalEditar(index) {
      const vendedores = JSON.parse(localStorage.getItem('vendedores') || '[]');
      const vendedor = vendedores[index];

      document.getElementById('editNome').value = vendedor.nome;
      document.getElementById('editLocalidade').value = vendedor.localidade;
      document.getElementById('editCotacao').value = vendedor.cotacao;

      document.getElementById('formEditarVendedor').dataset.index = index;

      document.getElementById('modalEditar').style.display = 'block';
      document.getElementById('overlayModal').style.display = 'block';
    }

    function fecharModalEditar() {
      document.getElementById('modalEditar').style.display = 'none';
      document.getElementById('overlayModal').style.display = 'none';
    }

    // Salvar edição
    document.getElementById('formEditarVendedor').addEventListener('submit', function(e) {
      e.preventDefault();
      const index = this.dataset.index;
      const nome = document.getElementById('editNome').value.trim();
      const localidade = document.getElementById('editLocalidade').value.trim();
      const cotacao = parseFloat(document.getElementById('editCotacao').value);

      if (!nome || !localidade || isNaN(cotacao)) {
        alert('Por favor, preencha todos os campos corretamente.');
        return;
      }

      let vendedores = JSON.parse(localStorage.getItem('vendedores') || '[]');
      vendedores[index] = { nome, localidade, cotacao };
      localStorage.setItem('vendedores', JSON.stringify(vendedores));
      fecharModalEditar();
      carregarVendedores();
      alert('Vendedor atualizado com sucesso!');
    });

    // Excluir vendedor
    function excluirVendedor(index) {
      if (!confirm('Tem certeza que deseja excluir este vendedor?')) return;

      let vendedores = JSON.parse(localStorage.getItem('vendedores') || '[]');
      vendedores.splice(index, 1);
      localStorage.setItem('vendedores', JSON.stringify(vendedores));
      carregarVendedores();
      alert('Vendedor excluído com sucesso!');
    }

    // Inicialização
    carregarNomeUsuario();
    carregarVendedores();
  </script>
<button class="btn" onclick="showSlide(1)">Voltar</button></div>
</div>



<!-- SLIDE 3: CADASTRO DE VENDEDORES -->
<div id="slide3" class="slide">
<button class="btn" onclick="showSlide(1)">Voltar</button>
  <style>
    #slide3 { background: #e8f4ff; padding: 20px; }
    #slide3 input, #slide3 button { margin: 5px 5px 15px 0; padding: 8px; }
    #listaVendedores { margin-top: 20px; }
    table { width: 100%; border-collapse: collapse; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background: #ddd; }
    button { cursor: pointer; }
    button.edit-btn { background-color: #4CAF50; color: white; border: none; padding: 5px 10px; margin-right: 5px; border-radius: 4px; }
    button.delete-btn { background-color: #f44336; color: white; border: none; padding: 5px 10px; border-radius: 4px; }
  </style>

  <h2>Cadastro de Vendedores</h2>

  <input id="nomeVendedor" placeholder="Nome do vendedor" />
  <input id="localidadeVendedor" placeholder="Localidade" />
  <input id="cotacaoVendedor" type="number" step="0.01" placeholder="Cotação" />
  <button class="btn" onclick="salvarVendedor()">Salvar</button>

  <div id="listaVendedores"></div>

  <script>
    let editandoIndex = -1;

    function salvarVendedor() {
      const nome = document.getElementById('nomeVendedor').value.trim();
      const localidade = document.getElementById('localidadeVendedor').value.trim();
      const cotacao = parseFloat(document.getElementById('cotacaoVendedor').value.trim());

      if (!nome || !localidade || isNaN(cotacao)) {
        alert('Preencha todos os campos corretamente.');
        return;
      }

      let vendedores = JSON.parse(localStorage.getItem('vendedores') || '[]');

      const novo = { nome, localidade, cotacao };

      if (editandoIndex >= 0) {
        vendedores[editandoIndex] = novo;
        editandoIndex = -1;
      } else {
        vendedores.push(novo);
      }

      localStorage.setItem('vendedores', JSON.stringify(vendedores));
      limparCampos();
      listarVendedores();
    }

    function listarVendedores() {
      const lista = document.getElementById('listaVendedores');
      lista.innerHTML = '';

      const vendedores = JSON.parse(localStorage.getItem('vendedores') || '[]');

      if (vendedores.length === 0) {
        lista.innerHTML = '<p>Nenhum vendedor cadastrado.</p>';
        return;
      }

      const tabela = document.createElement('table');

      tabela.innerHTML = `
        <thead>
          <tr>
            <th>Nome</th>
            <th>Localidade</th>
            <th>Cotação (R$)</th>
            <th>Ações</th>
          </tr>
        </thead>
        <tbody>
          ${vendedores.map((vend, i) => `
            <tr>
              <td>${vend.nome}</td>
              <td>${vend.localidade}</td>
              <td>${vend.cotacao.toFixed(2)}</td>
              <td>
                <button class="edit-btn" onclick="editarVendedor(${i})">Editar</button>
                <button class="delete-btn" onclick="excluirVendedor(${i})">Excluir</button>
              </td>
            </tr>
          `).join('')}
        </tbody>
      `;

      lista.appendChild(tabela);
    }

    function editarVendedor(index) {
      const vendedores = JSON.parse(localStorage.getItem('vendedores') || '[]');
      const vend = vendedores[index];

      document.getElementById('nomeVendedor').value = vend.nome;
      document.getElementById('localidadeVendedor').value = vend.localidade;
      document.getElementById('cotacaoVendedor').value = vend.cotacao;

      editandoIndex = index;
    }

    function excluirVendedor(index) {
      if (confirm('Deseja realmente excluir este vendedor?')) {
        let vendedores = JSON.parse(localStorage.getItem('vendedores') || '[]');
        vendedores.splice(index, 1);
        localStorage.setItem('vendedores', JSON.stringify(vendedores));
        listarVendedores();
      }
    }

    function limparCampos() {
      document.getElementById('nomeVendedor').value = '';
      document.getElementById('localidadeVendedor').value = '';
      document.getElementById('cotacaoVendedor').value = '';
      editandoIndex = -1;
    }

    // Carrega lista ao abrir o slide
    document.addEventListener('DOMContentLoaded', listarVendedores);
  </script>
</div>




<!-- SLIDE 4: VENDAS -->
<div id="slide4" class="slide">
<button class="btn" onclick="showSlide(1)">Voltar</button>
  <style>
    #slide4 { background: #fff8e1; }
    #vendedorSelecionado { font-weight: bold; margin-bottom: 10px; }
    table { width: 100%; border-collapse: collapse; margin-top: 15px; }
    th, td { border: 1px solid #ccc; padding: 6px; text-align: center; }
    input[type="number"], input[type="date"] { width: 100px; }
  </style>

  <h2>Lançamentos de Vendas</h2>
  <label for="selecioneVendedor">Selecione um vendedor:</label>
  <select id="selecioneVendedor" onchange="carregarHistorico()"></select>

  <div id="vendedorSelecionado"></div>

  <button class="btn" onclick="adicionarLinha()">Adicionar Venda</button>
  <button class="btn" onclick="salvarVendas()">Salvar</button>

  <table id="tabelaVendas">
    <thead>
      <tr>
        <th>Data</th>
        <th>Anterior</th>
        <th>Final</th>
        <th>Recebeu</th>
        <th>Devolveu</th>
        <th>Vendeu</th>
        <th>Apurou (R$)</th>
        <th>Pagou (R$)</th>
        <th>Deve (R$)</th>
        <th>Ações</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    let vendedorAtualIndex = null;

    function carregarVendedoresSelect() {
      const vendedores = JSON.parse(localStorage.getItem('vendedores') || '[]');
      const select = document.getElementById('selecioneVendedor');
      select.innerHTML = '<option value="">Selecione</option>';
      vendedores.forEach((v, i) => {
        const option = document.createElement('option');
        option.value = i;
        option.textContent = `${v.nome} (${v.localidade})`;
        select.appendChild(option);
      });
    }

    function carregarHistorico() {
      vendedorAtualIndex = document.getElementById('selecioneVendedor').value;
      const vendedores = JSON.parse(localStorage.getItem('vendedores') || '[]');

      if (vendedorAtualIndex === '') {
        document.getElementById('vendedorSelecionado').innerHTML = '';
        document.querySelector('#tabelaVendas tbody').innerHTML = '';
        return;
      }

      const vendedor = vendedores[vendedorAtualIndex];
      document.getElementById('vendedorSelecionado').innerText = `Vendedor: ${vendedor.nome} | Cotação: R$ ${vendedor.cotacao}`;

      const historico = JSON.parse(localStorage.getItem('historico_' + vendedor.nome) || '[]');
      desenharTabela(historico, vendedor.cotacao);
    }

    function desenharTabela(historico, cotacao) {
      const tbody = document.querySelector('#tabelaVendas tbody');
      tbody.innerHTML = '';

      historico.forEach((item, index) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><input type="date" value="${item.data || ''}" onchange="recalcular(${index})"></td>
          <td><input type="number" value="${item.anterior}" onchange="recalcular(${index})"></td>
          <td><input type="number" value="${item.final}" onchange="recalcular(${index})"></td>
          <td><input type="number" value="${item.recebeu}" readonly></td>
          <td><input type="number" value="${item.devolveu}" onchange="recalcular(${index})"></td>
          <td><input type="number" value="${item.vendeu}" readonly></td>
          <td><input type="number" value="${item.apurou}" readonly></td>
          <td><input type="number" value="${item.pagou}" onchange="recalcular(${index})"></td>
          <td><input type="number" value="${item.deve}" readonly></td>
          <td><button onclick="removerLinha(${index})">Remover</button></td>
        `;
        tbody.appendChild(tr);
      });
    }

    function adicionarLinha() {
      if (vendedorAtualIndex === null || vendedorAtualIndex === '') {
        alert('Selecione um vendedor primeiro.');
        return;
      }

      const vendedores = JSON.parse(localStorage.getItem('vendedores') || '[]');
      const vendedor = vendedores[vendedorAtualIndex];
      const historico = JSON.parse(localStorage.getItem('historico_' + vendedor.nome) || '[]');

      historico.push({
        data: '',
        anterior: 0,
        final: 0,
        recebeu: 0,
        devolveu: 0,
        vendeu: 0,
        apurou: 0,
        pagou: 0,
        deve: 0
      });

      localStorage.setItem('historico_' + vendedor.nome, JSON.stringify(historico));
      desenharTabela(historico, vendedor.cotacao);
    }

    function removerLinha(index) {
      const vendedores = JSON.parse(localStorage.getItem('vendedores') || '[]');
      const vendedor = vendedores[vendedorAtualIndex];
      let historico = JSON.parse(localStorage.getItem('historico_' + vendedor.nome) || '[]');

      historico.splice(index, 1);
      localStorage.setItem('historico_' + vendedor.nome, JSON.stringify(historico));
      desenharTabela(historico, vendedor.cotacao);
    }

    function salvarVendas() {
      const vendedores = JSON.parse(localStorage.getItem('vendedores') || '[]');
      const vendedor = vendedores[vendedorAtualIndex];

      const rows = document.querySelectorAll('#tabelaVendas tbody tr');
      const historico = [];

      rows.forEach(row => {
        const cells = row.querySelectorAll('input');
        historico.push({
          data: cells[0].value,
          anterior: parseInt(cells[1].value) || 0,
          final: parseInt(cells[2].value) || 0,
          recebeu: parseInt(cells[3].value) || 0,
          devolveu: parseInt(cells[4].value) || 0,
          vendeu: parseInt(cells[5].value) || 0,
          apurou: parseFloat(cells[6].value) || 0,
          pagou: parseFloat(cells[7].value) || 0,
          deve: parseFloat(cells[8].value) || 0
        });
      });

      localStorage.setItem('historico_' + vendedor.nome, JSON.stringify(historico));
      alert('Vendas salvas com sucesso!');
    }

    function recalcular(index) {
      const row = document.querySelectorAll('#tabelaVendas tbody tr')[index];
      const inputs = row.querySelectorAll('input');
      const anterior = parseInt(inputs[1].value) || 0;
      const final = parseInt(inputs[2].value) || 0;
      const devolveu = parseInt(inputs[4].value) || 0;
      const pagou = parseFloat(inputs[7].value) || 0;

      const recebeu = final - anterior;
      const vendeu = recebeu - devolveu;

      const vendedores = JSON.parse(localStorage.getItem('vendedores') || '[]');
      const vendedor = vendedores[vendedorAtualIndex];
      const cotacao = parseFloat(vendedor.cotacao);

      const apurou = vendeu * cotacao;
      const deve = apurou - pagou;

      inputs[3].value = recebeu;
      inputs[5].value = vendeu;
      inputs[6].value = apurou.toFixed(2);
      inputs[8].value = deve.toFixed(2);
    }

    document.addEventListener('DOMContentLoaded', carregarVendedoresSelect);
  </script>
</div>


<!-- SLIDE 5: LISTA DE DEVEDORES -->
<div id="slide5" class="slide">
<button class="btn" onclick="showSlide(1)">Voltar</button>
  <style>
    #slide5 { background: #ffe6e6; }
    #listaDevedores { margin-top: 20px; }
    .devedor { padding: 10px; margin-bottom: 10px; background: #fff; border-left: 5px solid red; }
  </style>

  <h2>Lista de Devedores</h2>
  <button class="btn" onclick="carregarDevedores()">Atualizar Lista</button>

  <div id="listaDevedores"></div>

  <script>
    function carregarDevedores() {
      const vendedores = JSON.parse(localStorage.getItem('vendedores') || '[]');
      const container = document.getElementById('listaDevedores');
      container.innerHTML = '';

      vendedores.forEach(vendedor => {
        const historico = JSON.parse(localStorage.getItem('historico_' + vendedor.nome) || '[]');
        const totalDeve = historico.reduce((acc, item) => acc + (parseFloat(item.deve) || 0), 0);

        if (totalDeve > 0) {
          const div = document.createE
